{"version":3,"file":"static/js/947.f719b7e2.chunk.js","mappings":"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","sources":["components/streamViewer/StreamViewer.js","pages/Home.jsx"],"sourcesContent":["import { useEffect, useRef } from \"react\";\r\n\r\nexport const StreamViewer = () => {\r\n  const videoRef = useRef(null);\r\n  const peerConnectionRef = useRef(null);\r\n  const socketRef = useRef(null);\r\n\r\n  const connectWebSocket = () => {\r\n    if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\r\n      console.log(\"üîÅ WebSocket –≤–∂–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ\");\r\n      return;\r\n    }\r\n\r\n    const protocol = window.location.protocol === \"https:\" ? \"wss\" : \"ws\";\r\n    const socket = new WebSocket(`${protocol}://192.168.0.103:8080`);\r\n    socketRef.current = socket;\r\n\r\n    socket.onopen = () => {\r\n      console.log(\"‚úÖ WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ\");\r\n    };\r\n\r\n    socket.onmessage = async (event) => {\r\n      try {\r\n        const message = JSON.parse(event.data);\r\n        console.log(\"üì© –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞:\", message);\r\n\r\n        if (message.offer) {\r\n          console.log(\"üé• –û—Ç—Ä–∏–º–∞–Ω–æ offer:\", message.offer);\r\n          await peerConnectionRef.current.setRemoteDescription(\r\n            new RTCSessionDescription(message.offer)\r\n          );\r\n          const answer = await peerConnectionRef.current.createAnswer();\r\n          await peerConnectionRef.current.setLocalDescription(answer);\r\n          socket.send(JSON.stringify({ answer }));\r\n        } else if (message.answer) {\r\n          console.log(\"üé• –û—Ç—Ä–∏–º–∞–Ω–æ answer:\", message.answer);\r\n          await peerConnectionRef.current.setRemoteDescription(\r\n            new RTCSessionDescription(message.answer)\r\n          );\r\n        } else if (message.iceCandidate) {\r\n          console.log(\"üßä –û—Ç—Ä–∏–º–∞–Ω–æ iceCandidate:\", message.iceCandidate);\r\n          await peerConnectionRef.current.addIceCandidate(\r\n            new RTCIceCandidate(message.iceCandidate)\r\n          );\r\n        } else {\r\n          console.warn(\"‚ö†Ô∏è –ù–µ–≤—ñ–¥–æ–º–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:\", message);\r\n        }\r\n      } catch (error) {\r\n        console.error(\r\n          \"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞:\",\r\n          error\r\n        );\r\n      }\r\n    };\r\n\r\n    socket.onerror = (err) => {\r\n      console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ WebSocket:\", err);\r\n    };\r\n\r\n    socket.onclose = () => {\r\n      console.log(\"‚ö†Ô∏è WebSocket –∑'—î–¥–Ω–∞–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç–æ\");\r\n    };\r\n  };\r\n\r\n  const initPeerConnection = () => {\r\n    if (peerConnectionRef.current) {\r\n      console.log(\"üîÅ PeerConnection –≤–∂–µ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ\");\r\n      return;\r\n    }\r\n\r\n    const peerConnection = new RTCPeerConnection({\r\n      iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\r\n    });\r\n\r\n    peerConnection.ontrack = (event) => {\r\n      if (videoRef.current) {\r\n        videoRef.current.srcObject = event.streams[0];\r\n      }\r\n    };\r\n\r\n    peerConnectionRef.current = peerConnection;\r\n  };\r\n\r\n  useEffect(() => {\r\n    initPeerConnection();\r\n    connectWebSocket();\r\n\r\n    const handleVisibilityChange = () => {\r\n      if (document.visibilityState === \"visible\") {\r\n        console.log(\"üëÄ –°—Ç–æ—Ä—ñ–Ω–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞, –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω–Ω—è...\");\r\n        initPeerConnection(); // –ü–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—å, —â–æ PeerConnection –∞–∫—Ç–∏–≤–Ω–µ\r\n        connectWebSocket(); // –ü–µ—Ä–µ–ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ WebSocket\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange);\r\n\r\n    return () => {\r\n      console.log(\"üßπ –û—á–∏—â–µ–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω—å...\");\r\n      document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\r\n\r\n      if (socketRef.current) {\r\n        socketRef.current.close();\r\n        socketRef.current = null;\r\n      }\r\n\r\n      if (peerConnectionRef.current) {\r\n        peerConnectionRef.current.close();\r\n        peerConnectionRef.current = null;\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <video ref={videoRef} autoPlay playsInline style={{ width: \"100%\" }} />\r\n  );\r\n};\r\n","import { StreamViewer } from \"../components/streamViewer/StreamViewer\";\r\n\r\nconst Home = () => {\r\n  return (\r\n    <div>\r\n      <h1>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É!</h1>\r\n      <p>\r\n        –¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ –∑ –≤—É–ª–∏–∫–∞ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é\r\n        –ø—Ä–æ –±–¥–∂—ñ–ª—å–Ω–∏—Ü—Ç–≤–æ.\r\n      </p>\r\n\r\n      <h2>üìπ –ü—Ä—è–º–∏–π –µ—Ñ—ñ—Ä –∑ –≤—É–ª–∏–∫–∞</h2>\r\n      <StreamViewer />\r\n\r\n      <h2>üêù –©–æ –º–∏ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ?</h2>\r\n      <p>–û—Ä–µ–Ω–¥–∞ –≤—É–ª–∏–∫—ñ–≤, –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ–¥—É–∫—Ü—ñ—ó —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –ø–∞—Å—ñ—á–Ω–∏–∫—ñ–≤.</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"names":["StreamViewer","videoRef","useRef","peerConnectionRef","socketRef","connectWebSocket","current","readyState","WebSocket","OPEN","console","log","protocol","window","location","socket","concat","onopen","onmessage","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","message","answer","wrap","_context","prev","next","JSON","parse","data","offer","setRemoteDescription","RTCSessionDescription","createAnswer","sent","setLocalDescription","send","stringify","iceCandidate","addIceCandidate","RTCIceCandidate","warn","t0","error","stop","_x","apply","arguments","onerror","err","onclose","initPeerConnection","peerConnection","RTCPeerConnection","iceServers","urls","ontrack","srcObject","streams","useEffect","handleVisibilityChange","document","visibilityState","addEventListener","removeEventListener","close","_jsx","ref","autoPlay","playsInline","style","width","_jsxs","children"],"sourceRoot":""}