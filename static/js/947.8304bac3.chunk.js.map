{"version":3,"file":"static/js/947.8304bac3.chunk.js","mappings":"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","sources":["components/streamViewer/StreamViewer.js","pages/Home.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\r\n\r\nexport const StreamViewer = () => {\r\n  const videoRef = useRef(null);\r\n  const socket = useRef(null);\r\n  const peerConnection = useRef(null);\r\n  const iceCandidateQueue = useRef([]);\r\n  const [streamReady, setStreamReady] = useState(false);\r\n\r\n  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è PeerConnection\r\n  const initializePeerConnection = () => {\r\n    peerConnection.current = new RTCPeerConnection({\r\n      iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\r\n    });\r\n\r\n    peerConnection.current.ontrack = (event) => {\r\n      console.log(\"‚úÖ –û—Ç—Ä–∏–º–∞–Ω–æ –ø–æ—Ç—ñ–∫:\", event.streams);\r\n      if (event.streams && event.streams[0] && videoRef.current) {\r\n        videoRef.current.srcObject = event.streams[0];\r\n        setStreamReady(true);\r\n        videoRef.current\r\n          .play()\r\n          .catch((e) => console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫—É:\", e));\r\n      } else {\r\n        console.warn(\"‚ùó –ü–æ—Ç—ñ–∫ –æ—Ç—Ä–∏–º–∞–Ω–æ, –∞–ª–µ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ –¥–æ video\");\r\n      }\r\n    };\r\n\r\n    peerConnection.current.onicecandidate = (event) => {\r\n      if (event.candidate) {\r\n        console.log(\"üßä –ù–∞–¥—Å–∏–ª–∞—î–º–æ ICE candidate:\", event.candidate);\r\n        if (socket.current?.readyState === WebSocket.OPEN) {\r\n          socket.current.send(\r\n            JSON.stringify({ iceCandidate: event.candidate })\r\n          );\r\n        } else {\r\n          console.warn(\r\n            \"‚ö†Ô∏è WebSocket –Ω–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è ICE candidate\"\r\n          );\r\n        }\r\n      }\r\n    };\r\n\r\n    peerConnection.current.oniceconnectionstatechange = () => {\r\n      console.log(\r\n        \"üßä ICE Connection State:\",\r\n        peerConnection.current.iceConnectionState\r\n      );\r\n    };\r\n  };\r\n\r\n  // –û–±—Ä–æ–±–∫–∞ ICE –∫–∞–Ω–¥–∏–¥–∞—Ç—ñ–≤ —ñ–∑ —á–µ—Ä–≥–∏\r\n  const processIceCandidates = async () => {\r\n    while (iceCandidateQueue.current.length) {\r\n      const candidate = iceCandidateQueue.current.shift();\r\n      try {\r\n        await peerConnection.current.addIceCandidate(\r\n          new RTCIceCandidate(candidate)\r\n        );\r\n        console.log(\"üßä –î–æ–¥–∞–Ω–æ ICE candidate –∑ —á–µ—Ä–≥–∏:\", candidate);\r\n      } catch (error) {\r\n        console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ ICE candidate –∑ —á–µ—Ä–≥–∏:\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    socket.current = new WebSocket(\"wss://192.168.0.103:8080\");\r\n\r\n    socket.current.onopen = () => {\r\n      console.log(\"‚úÖ WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ\");\r\n      initializePeerConnection();\r\n    };\r\n\r\n    socket.current.onmessage = async (event) => {\r\n      try {\r\n        const message = JSON.parse(event.data);\r\n        console.log(\"üì© –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞:\", message);\r\n\r\n        if (message.offer) {\r\n          console.log(\"üé• –û—Ç—Ä–∏–º–∞–Ω–æ offer:\", message.offer);\r\n          const signalingState = peerConnection.current.signalingState;\r\n          console.log(\"–¢–µ–∫—É—â–∏–π —Å—Ç–∞–Ω:\", signalingState);\r\n\r\n          if (signalingState === \"stable\") {\r\n            try {\r\n              await peerConnection.current.setRemoteDescription(\r\n                new RTCSessionDescription(message.offer)\r\n              );\r\n              console.log(\"‚úÖ RemoteDescription –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ\");\r\n\r\n              const answer = await peerConnection.current.createAnswer();\r\n              await peerConnection.current.setLocalDescription(answer);\r\n              if (socket.current?.readyState === WebSocket.OPEN) {\r\n                socket.current.send(JSON.stringify({ answer }));\r\n                console.log(\"‚úÖ Answer –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ:\", answer);\r\n              } else {\r\n                console.warn(\"‚ö†Ô∏è WebSocket –Ω–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è answer\");\r\n              }\r\n              await processIceCandidates();\r\n            } catch (error) {\r\n              console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ offer:\", error);\r\n            }\r\n          } else {\r\n            console.warn(\"‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å—Ç–∞–Ω –¥–ª—è offer:\", signalingState);\r\n          }\r\n        } else if (message.iceCandidate) {\r\n          console.log(\"üßä –û—Ç—Ä–∏–º–∞–Ω–æ iceCandidate:\", message.iceCandidate);\r\n          if (peerConnection.current.remoteDescription) {\r\n            try {\r\n              await peerConnection.current.addIceCandidate(\r\n                new RTCIceCandidate(message.iceCandidate)\r\n              );\r\n              console.log(\"üßä –î–æ–¥–∞–Ω–æ ICE candidate:\", message.iceCandidate);\r\n            } catch (error) {\r\n              console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ ICE candidate:\", error);\r\n            }\r\n          } else {\r\n            iceCandidateQueue.current.push(message.iceCandidate);\r\n            console.log(\r\n              \"üßä ICE candidate –¥–æ–¥–∞–Ω–æ –≤ —á–µ—Ä–≥—É:\",\r\n              message.iceCandidate\r\n            );\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:\", error);\r\n      }\r\n    };\r\n\r\n    socket.current.onerror = (err) => {\r\n      console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ WebSocket:\", err);\r\n    };\r\n\r\n    socket.current.onclose = () => {\r\n      console.log(\"‚ö†Ô∏è WebSocket –∑–∞–∫—Ä–∏—Ç–æ\");\r\n      if (peerConnection.current) {\r\n        peerConnection.current.close();\r\n        peerConnection.current = null;\r\n      }\r\n    };\r\n\r\n    return () => {\r\n      if (socket.current) socket.current.close();\r\n      if (peerConnection.current) peerConnection.current.close();\r\n    };\r\n  }, []);\r\n\r\n  // –†—É—á–Ω–∏–π –∑–∞–ø—É—Å–∫ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è\r\n  const handlePlay = () => {\r\n    if (videoRef.current) {\r\n      videoRef.current\r\n        .play()\r\n        .then(() => console.log(\"‚ñ∂Ô∏è –í—ñ–¥–µ–æ –≤—ñ–¥—Ç–≤–æ—Ä—é—î—Ç—å—Å—è\"))\r\n        .catch((e) => console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è:\", e));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ textAlign: \"center\" }}>\r\n      <video\r\n        ref={videoRef}\r\n        autoPlay\r\n        playsInline\r\n        muted\r\n        style={{ width: \"640px\", height: \"480px\", border: \"1px solid black\" }}\r\n      />\r\n      <br />\r\n      <button onClick={handlePlay} disabled={!streamReady}>\r\n        Play Video\r\n      </button>\r\n      {!streamReady && <p>–û—á—ñ–∫—É–≤–∞–Ω–Ω—è –ø–æ—Ç–æ–∫—É...</p>}\r\n    </div>\r\n  );\r\n};\r\n","import { StreamViewer } from \"../components/streamViewer/StreamViewer\";\r\n\r\nconst Home = () => {\r\n  return (\r\n    <div>\r\n      <h1>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É!</h1>\r\n      <p>\r\n        –¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ –∑ –≤—É–ª–∏–∫–∞ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é\r\n        –ø—Ä–æ –±–¥–∂—ñ–ª—å–Ω–∏—Ü—Ç–≤–æ.\r\n      </p>\r\n\r\n      <h2>üìπ –ü—Ä—è–º–∏–π –µ—Ñ—ñ—Ä –∑ –≤—É–ª–∏–∫–∞</h2>\r\n      <StreamViewer />\r\n\r\n      <h2>üêù –©–æ –º–∏ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ?</h2>\r\n      <p>–û—Ä–µ–Ω–¥–∞ –≤—É–ª–∏–∫—ñ–≤, –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ–¥—É–∫—Ü—ñ—ó —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –ø–∞—Å—ñ—á–Ω–∏–∫—ñ–≤.</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"names":["StreamViewer","videoRef","useRef","socket","peerConnection","iceCandidateQueue","_useState","useState","_useState2","_slicedToArray","streamReady","setStreamReady","processIceCandidates","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","candidate","wrap","_context","prev","next","current","length","shift","addIceCandidate","RTCIceCandidate","console","log","t0","error","stop","apply","arguments","useEffect","WebSocket","onopen","RTCPeerConnection","iceServers","urls","ontrack","event","streams","srcObject","play","catch","e","warn","onicecandidate","_socket$current","readyState","OPEN","send","JSON","stringify","iceCandidate","oniceconnectionstatechange","iceConnectionState","onmessage","_ref2","_callee2","message","signalingState","_socket$current2","answer","_context2","parse","data","offer","setRemoteDescription","RTCSessionDescription","createAnswer","sent","setLocalDescription","remoteDescription","t1","push","t2","_x","onerror","err","onclose","close","_jsxs","style","textAlign","children","_jsx","ref","autoPlay","playsInline","muted","width","height","border","onClick","then","disabled"],"sourceRoot":""}