{"version":3,"file":"static/js/947.0447986f.chunk.js","mappings":"gNAEaA,EAAe,WAC1B,IAAMC,GAAWC,EAAAA,EAAAA,QAAO,MAClBC,GAASD,EAAAA,EAAAA,QAAO,MAChBE,GAAiBF,EAAAA,EAAAA,QAAO,MAC9BG,GAA8CC,EAAAA,EAAAA,WAAS,GAAMC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAAtDI,EAAeF,EAAA,GAAEG,EAAkBH,EAAA,GAmJ1C,OAjJAI,EAAAA,EAAAA,YAAU,WAER,IAAMC,EAAwC,WAA7BC,OAAOC,SAASF,SAAwB,MAAQ,KA+FjE,OA9FAT,EAAOY,QAAU,IAAIC,UAAU,GAADC,OAAIL,EAAQ,0BAE1CT,EAAOY,QAAQG,OAAS,WACtBC,QAAQC,IAAI,iFACZV,GAAmB,EACrB,EAEAP,EAAOY,QAAQM,UAAS,eAAAC,GAAAC,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAG,SAAAC,EAAOC,GAAK,IAAAC,EAAAC,EAAA,OAAAL,EAAAA,EAAAA,KAAAM,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAGkB,GAHlBF,EAAAC,KAAA,EAE7BJ,EAAUM,KAAKC,MAAMR,EAAMS,MACjCjB,QAAQC,IAAI,uJAAgCQ,IAExCA,EAAQS,MAAM,CAADN,EAAAE,KAAA,SAIf,GAFAd,QAAQC,IAAI,uEAAsBQ,EAAQS,OAIE,WAA1CjC,EAAeW,QAAQuB,gBACmB,qBAA1ClC,EAAeW,QAAQuB,eAAqC,CAAAP,EAAAE,KAAA,gBAAAF,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAGpD7B,EAAeW,QAAQwB,qBAC3B,IAAIC,sBAAsBZ,EAAQS,QAClC,KAAD,SAAAN,EAAAE,KAAA,GACoB7B,EAAeW,QAAQ0B,eAAe,KAAD,GAA9C,OAANZ,EAAME,EAAAW,KAAAX,EAAAE,KAAA,GACN7B,EAAeW,QAAQ4B,oBAAoBd,GAAQ,KAAD,GACxD1B,EAAOY,QAAQ6B,KAAKV,KAAKW,UAAU,CAAEhB,OAAAA,KAAWE,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAe,GAAAf,EAAA,SAEhDZ,QAAQ4B,MAAM,yHAA8BhB,EAAAe,IAAS,QAAAf,EAAAE,KAAA,iBAGvDd,QAAQ6B,KACN,+MACA5C,EAAeW,QAAQuB,gBACvB,QAAAP,EAAAE,KAAA,qBAEKL,EAAQC,OAAO,CAADE,EAAAE,KAAA,SAE4B,GAAnDd,QAAQC,IAAI,wEAAuBQ,EAAQC,QAEG,qBAA1CzB,EAAeW,QAAQuB,eAAqC,CAAAP,EAAAE,KAAA,gBAAAF,EAAAC,KAAA,GAAAD,EAAAE,KAAA,GAEtD7B,EAAeW,QAAQwB,qBAC3B,IAAIC,sBAAsBZ,EAAQC,SAClC,KAAD,GAAAE,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAkB,GAAAlB,EAAA,UAEDZ,QAAQ4B,MAAM,0HAA+BhB,EAAAkB,IAAS,QAAAlB,EAAAE,KAAA,iBAGxDd,QAAQ6B,KACN,oMACA5C,EAAeW,QAAQuB,gBACvB,QAAAP,EAAAE,KAAA,qBAEKL,EAAQsB,aAAa,CAADnB,EAAAE,KAAA,SAI7B,GAFAd,QAAQC,IAAI,8EAA6BQ,EAAQsB,eAG7C9C,EAAeW,QAAQoC,kBAAkB,CAADpB,EAAAE,KAAA,gBAAAF,EAAAC,KAAA,GAAAD,EAAAE,KAAA,GAElC7B,EAAeW,QAAQqC,gBAC3B,IAAIC,gBAAgBzB,EAAQsB,eAC5B,KAAD,GAAAnB,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAuB,GAAAvB,EAAA,UAEDZ,QAAQ4B,MAAM,4IAAuChB,EAAAuB,IAAS,QAAAvB,EAAAE,KAAA,iBAGhEd,QAAQ6B,KACN,gKACA,QAAAjB,EAAAE,KAAA,iBAGJd,QAAQ6B,KAAK,0IAA6BpB,GAAS,QAAAG,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAwB,GAAAxB,EAAA,SAGrDZ,QAAQ4B,MACN,iQAAmDhB,EAAAwB,IAEnD,yBAAAxB,EAAAyB,OAAA,GAAA9B,EAAA,0CAEL,gBAAA+B,GAAA,OAAAnC,EAAAoC,MAAA,KAAAC,UAAA,EA3EuB,GA6ExBxD,EAAOY,QAAQ6C,QAAU,SAACC,GACxB1C,QAAQ4B,MAAM,+DAAwBc,EACxC,EAEA1D,EAAOY,QAAQ+C,QAAU,WACvB3C,QAAQC,IAAI,uHACZV,GAAmB,EACrB,EAGO,WACDP,EAAOY,SACTZ,EAAOY,QAAQgD,QAEb3D,EAAeW,SACjBX,EAAeW,QAAQgD,OAE3B,CACF,GAAG,KAEHpD,EAAAA,EAAAA,YAAU,WACR,GAAIF,EAAiB,CAEnBL,EAAeW,QAAU,IAAIiD,kBAAkB,CAC7CC,WAAY,CAAC,CAAEC,KAAM,mCAIvB,IAAMC,EAAS,eAAAC,GAAA7C,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAG,SAAA4C,IAAA,IAAAhC,EAAA,OAAAb,EAAAA,EAAAA,KAAAM,MAAA,SAAAwC,GAAA,cAAAA,EAAAtC,KAAAsC,EAAArC,MAAA,cAAAqC,EAAAtC,KAAA,EAAAsC,EAAArC,KAAA,EAEM7B,EAAeW,QAAQwD,cAAc,KAAD,EAA7C,OAALlC,EAAKiC,EAAA5B,KAAA4B,EAAArC,KAAA,EACL7B,EAAeW,QAAQ4B,oBAAoBN,GAAO,KAAD,EACvDlC,EAAOY,QAAQ6B,KAAKV,KAAKW,UAAU,CAAER,MAAAA,KACrClB,QAAQC,IAAI,kHAA8BiB,GAAOiC,EAAArC,KAAA,iBAAAqC,EAAAtC,KAAA,GAAAsC,EAAAxB,GAAAwB,EAAA,SAEjDnD,QAAQ4B,MAAM,qIAAgCuB,EAAAxB,IAAS,yBAAAwB,EAAAd,OAAA,GAAAa,EAAA,mBAE1D,kBATc,OAAAD,EAAAV,MAAA,KAAAC,UAAA,KAsBf,OAXAQ,IAEA/D,EAAeW,QAAQyD,QAAU,SAAC7C,GAC5BA,EAAM8C,SAAW9C,EAAM8C,QAAQ,IAAMxE,EAASc,QAChDd,EAASc,QAAQ2D,UAAY/C,EAAM8C,QAAQ,GAE3CtD,QAAQ6B,KAAK,4GAEjB,EAGO,WACD5C,EAAeW,SACjBX,EAAeW,QAAQgD,OAE3B,CACF,CACF,GAAG,CAACtD,KAEGkE,EAAAA,EAAAA,KAAA,SAAOC,IAAK3E,EAAU4E,UAAQ,EAACC,aAAW,GACnD,ECtIA,EAlBa,WACX,OACEC,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEL,EAAAA,EAAAA,KAAA,MAAAK,SAAI,gKACJL,EAAAA,EAAAA,KAAA,KAAAK,SAAG,2dAKHL,EAAAA,EAAAA,KAAA,MAAAK,SAAI,4HACJL,EAAAA,EAAAA,KAAC3E,EAAY,KAEb2E,EAAAA,EAAAA,KAAA,MAAAK,SAAI,0GACJL,EAAAA,EAAAA,KAAA,KAAAK,SAAG,kUAGT,C","sources":["components/streamViewer/StreamViewer.js","pages/Home.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\r\n\r\nexport const StreamViewer = () => {\r\n  const videoRef = useRef(null);\r\n  const socket = useRef(null);\r\n  const peerConnection = useRef(null);\r\n  const [socketConnected, setSocketConnected] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è WebSocket\r\n    const protocol = window.location.protocol === \"https:\" ? \"wss\" : \"ws\";\r\n    socket.current = new WebSocket(`${protocol}://192.168.0.103:8080`);\r\n\r\n    socket.current.onopen = () => {\r\n      console.log(\"‚úÖ WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ\");\r\n      setSocketConnected(true);\r\n    };\r\n\r\n    socket.current.onmessage = async (event) => {\r\n      try {\r\n        const message = JSON.parse(event.data);\r\n        console.log(\"üì© –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞:\", message);\r\n\r\n        if (message.offer) {\r\n          // –û—Ç—Ä–∏–º–∞–Ω–Ω—è offer —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è answer\r\n          console.log(\"üé• –û—Ç—Ä–∏–º–∞–Ω–æ offer:\", message.offer);\r\n\r\n          // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–Ω—É –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è–º remoteDescription\r\n          if (\r\n            peerConnection.current.signalingState === \"stable\" ||\r\n            peerConnection.current.signalingState === \"have-local-offer\"\r\n          ) {\r\n            try {\r\n              await peerConnection.current.setRemoteDescription(\r\n                new RTCSessionDescription(message.offer)\r\n              );\r\n              const answer = await peerConnection.current.createAnswer();\r\n              await peerConnection.current.setLocalDescription(answer);\r\n              socket.current.send(JSON.stringify({ answer }));\r\n            } catch (error) {\r\n              console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ offer:\", error);\r\n            }\r\n          } else {\r\n            console.warn(\r\n              \"‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å—Ç–∞–Ω –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ remoteDescription: \",\r\n              peerConnection.current.signalingState\r\n            );\r\n          }\r\n        } else if (message.answer) {\r\n          // –û—Ç—Ä–∏–º–∞–Ω–Ω—è answer\r\n          console.log(\"üé• –û—Ç—Ä–∏–º–∞–Ω–æ answer:\", message.answer);\r\n\r\n          if (peerConnection.current.signalingState === \"have-local-offer\") {\r\n            try {\r\n              await peerConnection.current.setRemoteDescription(\r\n                new RTCSessionDescription(message.answer)\r\n              );\r\n            } catch (error) {\r\n              console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ answer:\", error);\r\n            }\r\n          } else {\r\n            console.warn(\r\n              \"‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å—Ç–∞–Ω –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ answer: \",\r\n              peerConnection.current.signalingState\r\n            );\r\n          }\r\n        } else if (message.iceCandidate) {\r\n          // –û—Ç—Ä–∏–º–∞–Ω–Ω—è iceCandidate\r\n          console.log(\"üßä –û—Ç—Ä–∏–º–∞–Ω–æ iceCandidate:\", message.iceCandidate);\r\n\r\n          // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å remoteDescription –ø–µ—Ä–µ–¥ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º iceCandidate\r\n          if (peerConnection.current.remoteDescription) {\r\n            try {\r\n              await peerConnection.current.addIceCandidate(\r\n                new RTCIceCandidate(message.iceCandidate)\r\n              );\r\n            } catch (error) {\r\n              console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ iceCandidate:\", error);\r\n            }\r\n          } else {\r\n            console.warn(\r\n              \"‚ö†Ô∏è –ù–µ–º–∞—î remoteDescription, iceCandidate –Ω–µ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏\"\r\n            );\r\n          }\r\n        } else {\r\n          console.warn(\"‚ö†Ô∏è –ù–µ–≤—ñ–¥–æ–º–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:\", message);\r\n        }\r\n      } catch (error) {\r\n        console.error(\r\n          \"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞: \",\r\n          error\r\n        );\r\n      }\r\n    };\r\n\r\n    socket.current.onerror = (err) => {\r\n      console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ WebSocket:\", err);\r\n    };\r\n\r\n    socket.current.onclose = () => {\r\n      console.log(\"‚ö†Ô∏è WebSocket –∑'—î–¥–Ω–∞–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç–æ\");\r\n      setSocketConnected(false); // –Ø–∫—â–æ WebSocket –∑–∞–∫—Ä–∏—Ç–æ, –∑–º—ñ–Ω—é—î–º–æ —Å—Ç–∞–Ω\r\n    };\r\n\r\n    // –û—á–∏—â–µ–Ω–Ω—è –ø—Ä–∏ –¥–µ–º–æ–Ω—Ç–æ–≤–∞–Ω–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ\r\n    return () => {\r\n      if (socket.current) {\r\n        socket.current.close();\r\n      }\r\n      if (peerConnection.current) {\r\n        peerConnection.current.close();\r\n      }\r\n    };\r\n  }, []); // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è WebSocket –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ª–∏—à–µ –æ–¥–∏–Ω —Ä–∞–∑\r\n\r\n  useEffect(() => {\r\n    if (socketConnected) {\r\n      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è WebRTC –ø—Ä–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—ñ WebSocket\r\n      peerConnection.current = new RTCPeerConnection({\r\n        iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\r\n      });\r\n\r\n      // –ù–∞–¥—Å–∏–ª–∞—î–º–æ offer –ø—Ä–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—ñ WebSocket\r\n      const sendOffer = async () => {\r\n        try {\r\n          const offer = await peerConnection.current.createOffer();\r\n          await peerConnection.current.setLocalDescription(offer);\r\n          socket.current.send(JSON.stringify({ offer }));\r\n          console.log(\"üé• –ù–∞–¥—Å–∏–ª–∞—î–º–æ –Ω–æ–≤–∏–π offer:\", offer);\r\n        } catch (error) {\r\n          console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ offer:\", error);\r\n        }\r\n      };\r\n\r\n      sendOffer();\r\n\r\n      peerConnection.current.ontrack = (event) => {\r\n        if (event.streams && event.streams[0] && videoRef.current) {\r\n          videoRef.current.srcObject = event.streams[0];\r\n        } else {\r\n          console.warn(\"‚ùó –ü–æ—Ç—ñ–∫ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∏–π\");\r\n        }\r\n      };\r\n\r\n      // –û—á–∏—â–µ–Ω–Ω—è –ø—Ä–∏ –∑–∞–∫—Ä–∏—Ç—Ç—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è\r\n      return () => {\r\n        if (peerConnection.current) {\r\n          peerConnection.current.close();\r\n        }\r\n      };\r\n    }\r\n  }, [socketConnected]); // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ WebRTC —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è WebSocket\r\n\r\n  return <video ref={videoRef} autoPlay playsInline />;\r\n};\r\n","import { StreamViewer } from \"../components/streamViewer/StreamViewer\";\r\n\r\nconst Home = () => {\r\n  return (\r\n    <div>\r\n      <h1>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É!</h1>\r\n      <p>\r\n        –¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ –∑ –≤—É–ª–∏–∫–∞ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é\r\n        –ø—Ä–æ –±–¥–∂—ñ–ª—å–Ω–∏—Ü—Ç–≤–æ.\r\n      </p>\r\n\r\n      <h2>üìπ –ü—Ä—è–º–∏–π –µ—Ñ—ñ—Ä –∑ –≤—É–ª–∏–∫–∞</h2>\r\n      <StreamViewer />\r\n\r\n      <h2>üêù –©–æ –º–∏ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ?</h2>\r\n      <p>–û—Ä–µ–Ω–¥–∞ –≤—É–ª–∏–∫—ñ–≤, –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ–¥—É–∫—Ü—ñ—ó —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –ø–∞—Å—ñ—á–Ω–∏–∫—ñ–≤.</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"names":["StreamViewer","videoRef","useRef","socket","peerConnection","_useState","useState","_useState2","_slicedToArray","socketConnected","setSocketConnected","useEffect","protocol","window","location","current","WebSocket","concat","onopen","console","log","onmessage","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","message","answer","wrap","_context","prev","next","JSON","parse","data","offer","signalingState","setRemoteDescription","RTCSessionDescription","createAnswer","sent","setLocalDescription","send","stringify","t0","error","warn","t1","iceCandidate","remoteDescription","addIceCandidate","RTCIceCandidate","t2","t3","stop","_x","apply","arguments","onerror","err","onclose","close","RTCPeerConnection","iceServers","urls","sendOffer","_ref2","_callee2","_context2","createOffer","ontrack","streams","srcObject","_jsx","ref","autoPlay","playsInline","_jsxs","children"],"sourceRoot":""}