{"version":3,"file":"static/js/947.9ef52b5c.chunk.js","mappings":"0NAUaA,EAAe,WAC1B,IAAMC,GAAWC,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,QAAO,MAExBC,GAAgDC,EAAAA,EAAAA,KAC9C,SAACC,GAAK,OAAKA,EAAMC,MAAM,IADJC,GAAFJ,EAAXK,YAA2BL,EAAdI,gBAAgBE,EAAMN,EAANM,OAmErC,OA/DAC,EAAAA,EAAAA,YAAU,WACR,IAAIC,EAAKJ,EACLK,EAAKH,EAET,GAAKF,GAAmBE,EAmDtBI,QAAQC,IAAI,qMAnDkB,CAC9BH,EAAK,IAAII,kBAAkB,CACzBC,WAAY,CAAC,CAAEC,KAAM,mCAGvB,IAAMC,EAAwC,WAA7BC,OAAOC,SAASF,SAAwB,MAAQ,KACjEN,EAAK,IAAIS,UAAU,GAADC,OAAIJ,EAAQ,0BAE9BnB,GAASwB,EAAAA,EAAAA,IAAkBZ,IAC3BZ,GAASyB,EAAAA,EAAAA,IAAUZ,IAEnBA,EAAGa,OAAS,WACVZ,QAAQC,IAAI,iFACZf,GAAS2B,EAAAA,EAAAA,KAAe,GAC1B,EAEAd,EAAGe,UAAS,eAAAC,GAAAC,EAAAA,EAAAA,IAAAC,EAAAA,EAAAA,KAAAC,MAAG,SAAAC,EAAOC,GAAK,IAAAC,EAAAC,EAAA,OAAAL,EAAAA,EAAAA,KAAAM,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAEgB,GAFhBF,EAAAC,KAAA,IAEjBJ,EAAUM,KAAKC,MAAMR,EAAMS,OACrBC,MAAM,CAADN,EAAAE,KAAA,gBAAAF,EAAAE,KAAA,EACT5B,EAAGiC,qBACP,IAAIC,sBAAsBX,EAAQS,QAClC,KAAD,SAAAN,EAAAE,KAAA,EACoB5B,EAAGmC,eAAe,KAAD,EAA1B,OAANX,EAAME,EAAAU,KAAAV,EAAAE,KAAA,GACN5B,EAAGqC,oBAAoBb,GAAQ,KAAD,GACpCvB,EAAGqC,KAAKT,KAAKU,UAAU,CAAEf,OAAAA,KAAWE,EAAAE,KAAA,qBAC3BL,EAAQiB,aAAa,CAADd,EAAAE,KAAA,gBAAAF,EAAAE,KAAA,GACvB5B,EAAGyC,gBAAgB,IAAIC,gBAAgBnB,EAAQiB,eAAe,KAAD,GAAAd,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAiB,GAAAjB,EAAA,SAGrExB,QAAQ0C,MAAM,4LAAqClB,EAAAiB,IAAS,yBAAAjB,EAAAmB,OAAA,GAAAxB,EAAA,mBAE/D,gBAAAyB,GAAA,OAAA7B,EAAA8B,MAAA,KAAAC,UAAA,EAhBW,GAkBZhD,EAAGiD,QAAU,SAAC3B,GACRhC,EAAS4D,UACX5D,EAAS4D,QAAQC,UAAY7B,EAAM8B,QAAQ,GAE/C,EAEApD,EAAGqD,eAAiB,SAAC/B,GACfA,EAAMgC,WACRrD,EAAGqC,KAAKT,KAAKU,UAAU,CAAEC,aAAclB,EAAMgC,YAEjD,EAEArD,EAAGsD,QAAU,WACXrD,QAAQC,IAAI,uHACZf,GAAS2B,EAAAA,EAAAA,KAAe,GAC1B,CACF,CAIA,OAAO,WACL,CAEJ,GAAG,CAAC3B,EAAUQ,EAAgBE,KAEvB0D,EAAAA,EAAAA,KAAA,SAAOC,IAAKnE,EAAUoE,UAAQ,EAACC,aAAW,GACnD,EC9DA,EAlBa,WACX,OACEC,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEL,EAAAA,EAAAA,KAAA,MAAAK,SAAI,gKACJL,EAAAA,EAAAA,KAAA,KAAAK,SAAG,2dAKHL,EAAAA,EAAAA,KAAA,MAAAK,SAAI,4HACJL,EAAAA,EAAAA,KAACrE,EAAY,KAEbqE,EAAAA,EAAAA,KAAA,MAAAK,SAAI,0GACJL,EAAAA,EAAAA,KAAA,KAAAK,SAAG,kUAGT,C","sources":["components/streamViewer/StreamViewer.js","pages/Home.jsx"],"sourcesContent":["import { useEffect, useRef } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n\r\nimport {\r\n  setIsConnected,\r\n  setPeerConnection,\r\n  setSocket,\r\n  resetWebRTC,\r\n} from \"../../redux/webrtcSlice\";\r\n\r\nexport const StreamViewer = () => {\r\n  const dispatch = useDispatch();\r\n  const videoRef = useRef(null);\r\n\r\n  const { isConnected, peerConnection, socket } = useSelector(\r\n    (state) => state.webrtc\r\n  );\r\n\r\n  useEffect(() => {\r\n    let pc = peerConnection;\r\n    let ws = socket;\r\n\r\n    if (!peerConnection || !socket) {\r\n      pc = new RTCPeerConnection({\r\n        iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\r\n      });\r\n\r\n      const protocol = window.location.protocol === \"https:\" ? \"wss\" : \"ws\";\r\n      ws = new WebSocket(`${protocol}://192.168.0.103:8080`);\r\n\r\n      dispatch(setPeerConnection(pc));\r\n      dispatch(setSocket(ws));\r\n\r\n      ws.onopen = () => {\r\n        console.log(\"‚úÖ WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ\");\r\n        dispatch(setIsConnected(true));\r\n      };\r\n\r\n      ws.onmessage = async (event) => {\r\n        try {\r\n          const message = JSON.parse(event.data);\r\n          if (message.offer) {\r\n            await pc.setRemoteDescription(\r\n              new RTCSessionDescription(message.offer)\r\n            );\r\n            const answer = await pc.createAnswer();\r\n            await pc.setLocalDescription(answer);\r\n            ws.send(JSON.stringify({ answer }));\r\n          } else if (message.iceCandidate) {\r\n            await pc.addIceCandidate(new RTCIceCandidate(message.iceCandidate));\r\n          }\r\n        } catch (error) {\r\n          console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:\", error);\r\n        }\r\n      };\r\n\r\n      pc.ontrack = (event) => {\r\n        if (videoRef.current) {\r\n          videoRef.current.srcObject = event.streams[0];\r\n        }\r\n      };\r\n\r\n      pc.onicecandidate = (event) => {\r\n        if (event.candidate) {\r\n          ws.send(JSON.stringify({ iceCandidate: event.candidate }));\r\n        }\r\n      };\r\n\r\n      ws.onclose = () => {\r\n        console.log(\"‚ö†Ô∏è WebSocket –∑'—î–¥–Ω–∞–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç–æ\");\r\n        dispatch(setIsConnected(false));\r\n      };\r\n    } else {\r\n      console.log(\"üìπ –í—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ–¥–µ–æ–ø–æ—Ç–æ–∫—É –∞–∫—Ç–∏–≤–Ω–µ\");\r\n    }\r\n\r\n    return () => {\r\n      // –ù–µ –∑–∞–∫—Ä–∏–≤–∞—î–º–æ –∑'—î–¥–Ω–∞–Ω–Ω—è, —â–æ–± –Ω–µ —Å–∫–∏–¥–∞—Ç–∏ —Å—Ç–∞–Ω\r\n    };\r\n  }, [dispatch, peerConnection, socket]);\r\n\r\n  return <video ref={videoRef} autoPlay playsInline />;\r\n};\r\n","import { StreamViewer } from \"../components/streamViewer/StreamViewer\";\r\n\r\nconst Home = () => {\r\n  return (\r\n    <div>\r\n      <h1>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É!</h1>\r\n      <p>\r\n        –¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ –∑ –≤—É–ª–∏–∫–∞ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é\r\n        –ø—Ä–æ –±–¥–∂—ñ–ª—å–Ω–∏—Ü—Ç–≤–æ.\r\n      </p>\r\n\r\n      <h2>üìπ –ü—Ä—è–º–∏–π –µ—Ñ—ñ—Ä –∑ –≤—É–ª–∏–∫–∞</h2>\r\n      <StreamViewer />\r\n\r\n      <h2>üêù –©–æ –º–∏ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ?</h2>\r\n      <p>–û—Ä–µ–Ω–¥–∞ –≤—É–ª–∏–∫—ñ–≤, –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ–¥—É–∫—Ü—ñ—ó —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –ø–∞—Å—ñ—á–Ω–∏–∫—ñ–≤.</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"names":["StreamViewer","dispatch","useDispatch","videoRef","useRef","_useSelector","useSelector","state","webrtc","peerConnection","isConnected","socket","useEffect","pc","ws","console","log","RTCPeerConnection","iceServers","urls","protocol","window","location","WebSocket","concat","setPeerConnection","setSocket","onopen","setIsConnected","onmessage","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","message","answer","wrap","_context","prev","next","JSON","parse","data","offer","setRemoteDescription","RTCSessionDescription","createAnswer","sent","setLocalDescription","send","stringify","iceCandidate","addIceCandidate","RTCIceCandidate","t0","error","stop","_x","apply","arguments","ontrack","current","srcObject","streams","onicecandidate","candidate","onclose","_jsx","ref","autoPlay","playsInline","_jsxs","children"],"sourceRoot":""}