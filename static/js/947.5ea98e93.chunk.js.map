{"version":3,"file":"static/js/947.5ea98e93.chunk.js","mappings":"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","sources":["components/streamViewer/StreamViewer.js","pages/Home.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\r\n\r\nexport const StreamViewer = () => {\r\n  const videoRef = useRef(null);\r\n  const [socketConnected, setSocketConnected] = useState(false);\r\n  const [peerConnection, setPeerConnection] = useState(null);\r\n  const [socket, setSocket] = useState(null);\r\n\r\n  useEffect(() => {\r\n    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è WebRTC —ñ WebSocket\r\n    const initializeWebRTC = () => {\r\n      const peerConnection = new RTCPeerConnection({\r\n        iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\r\n      });\r\n\r\n      // –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –¥–ª—è iceCandidate\r\n      peerConnection.onicecandidate = (event) => {\r\n        if (event.candidate) {\r\n          console.log(\"üßä –ù–∞–¥—Å–∏–ª–∞—î–º–æ iceCandidate\", event.candidate);\r\n          socket.send(JSON.stringify({ iceCandidate: event.candidate }));\r\n        }\r\n      };\r\n\r\n      // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–µ–æ –ø–æ—Ç–æ–∫—É\r\n      peerConnection.ontrack = (event) => {\r\n        if (event.streams && event.streams[0] && videoRef.current) {\r\n          videoRef.current.srcObject = event.streams[0];\r\n        } else {\r\n          console.warn(\"‚ùó –ü–æ—Ç—ñ–∫ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∏–π\");\r\n        }\r\n      };\r\n\r\n      return peerConnection;\r\n    };\r\n\r\n    const socket = new WebSocket(\r\n      `${\r\n        window.location.protocol === \"https:\" ? \"wss\" : \"ws\"\r\n      }://192.168.0.103:8080`\r\n    );\r\n\r\n    // –õ–æ–≥—É–≤–∞–Ω–Ω—è WebSocket\r\n    socket.onopen = () => {\r\n      console.log(\"‚úÖ WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ\");\r\n      setSocketConnected(true);\r\n    };\r\n\r\n    socket.onmessage = async (event) => {\r\n      try {\r\n        const message = JSON.parse(event.data);\r\n        console.log(\"üì© –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞:\", message);\r\n\r\n        if (message.offer) {\r\n          console.log(\"üé• –û—Ç—Ä–∏–º–∞–Ω–æ offer:\", message.offer);\r\n          await peerConnection.setRemoteDescription(\r\n            new RTCSessionDescription(message.offer)\r\n          );\r\n          const answer = await peerConnection.createAnswer();\r\n          await peerConnection.setLocalDescription(answer);\r\n          socket.send(JSON.stringify({ answer }));\r\n        } else if (message.answer) {\r\n          console.log(\"üé• –û—Ç—Ä–∏–º–∞–Ω–æ answer:\", message.answer);\r\n          await peerConnection.setRemoteDescription(\r\n            new RTCSessionDescription(message.answer)\r\n          );\r\n        } else if (message.iceCandidate) {\r\n          console.log(\"üßä –û—Ç—Ä–∏–º–∞–Ω–æ iceCandidate:\", message.iceCandidate);\r\n          await peerConnection.addIceCandidate(\r\n            new RTCIceCandidate(message.iceCandidate)\r\n          );\r\n        } else {\r\n          console.warn(\"‚ö†Ô∏è –ù–µ–≤—ñ–¥–æ–º–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:\", message);\r\n        }\r\n      } catch (error) {\r\n        console.error(\r\n          \"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞:\",\r\n          error\r\n        );\r\n      }\r\n    };\r\n\r\n    socket.onerror = (err) => {\r\n      console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ WebSocket:\", err);\r\n    };\r\n\r\n    socket.onclose = () => {\r\n      console.log(\"‚ö†Ô∏è WebSocket –∑'—î–¥–Ω–∞–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç–æ\");\r\n      setSocketConnected(false);\r\n    };\r\n\r\n    const peerConnectionInstance = initializeWebRTC();\r\n    setPeerConnection(peerConnectionInstance);\r\n    setSocket(socket);\r\n\r\n    return () => {\r\n      peerConnectionInstance.close(); // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ peerConnection\r\n      socket.close(); // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ WebSocket\r\n    };\r\n  }, [peerConnection]);\r\n\r\n  useEffect(() => {\r\n    if (socketConnected && peerConnection) {\r\n      const sendOffer = async () => {\r\n        try {\r\n          const offer = await peerConnection.createOffer();\r\n          await peerConnection.setLocalDescription(offer);\r\n          socket.send(\r\n            JSON.stringify({ offer: peerConnection.localDescription })\r\n          );\r\n          console.log(\"üé• –ù–∞–¥—Å–∏–ª–∞—î–º–æ –Ω–æ–≤–∏–π offer:\", offer);\r\n        } catch (error) {\r\n          console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ offer:\", error);\r\n        }\r\n      };\r\n\r\n      // –ù–∞–¥—Å–∏–ª–∞—î–º–æ –Ω–æ–≤–∏–π offer –ø—Ä–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è\r\n      sendOffer();\r\n    }\r\n  }, [socketConnected, peerConnection, socket]);\r\n\r\n  return <video ref={videoRef} autoPlay playsInline />;\r\n};\r\n","import { StreamViewer } from \"../components/streamViewer/StreamViewer\";\r\n\r\nconst Home = () => {\r\n  return (\r\n    <div>\r\n      <h1>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É!</h1>\r\n      <p>\r\n        –¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ –∑ –≤—É–ª–∏–∫–∞ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é\r\n        –ø—Ä–æ –±–¥–∂—ñ–ª—å–Ω–∏—Ü—Ç–≤–æ.\r\n      </p>\r\n\r\n      <h2>üìπ –ü—Ä—è–º–∏–π –µ—Ñ—ñ—Ä –∑ –≤—É–ª–∏–∫–∞</h2>\r\n      <StreamViewer />\r\n\r\n      <h2>üêù –©–æ –º–∏ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ?</h2>\r\n      <p>–û—Ä–µ–Ω–¥–∞ –≤—É–ª–∏–∫—ñ–≤, –ø—Ä–æ–¥–∞–∂ –ø—Ä–æ–¥—É–∫—Ü—ñ—ó —Ç–∞ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –ø–∞—Å—ñ—á–Ω–∏–∫—ñ–≤.</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"names":["StreamViewer","videoRef","useRef","_useState","useState","_useState2","_slicedToArray","socketConnected","setSocketConnected","_useState3","_useState4","peerConnection","setPeerConnection","_useState5","_useState6","socket","setSocket","useEffect","WebSocket","concat","window","location","protocol","onopen","console","log","onmessage","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","message","answer","wrap","_context","prev","next","JSON","parse","data","offer","setRemoteDescription","RTCSessionDescription","createAnswer","sent","setLocalDescription","send","stringify","iceCandidate","addIceCandidate","RTCIceCandidate","warn","t0","error","stop","_x","apply","arguments","onerror","err","onclose","peerConnectionInstance","RTCPeerConnection","iceServers","urls","onicecandidate","candidate","ontrack","streams","current","srcObject","initializeWebRTC","close","sendOffer","_ref2","_callee2","_context2","createOffer","localDescription","_jsx","ref","autoPlay","playsInline","_jsxs","children"],"sourceRoot":""}